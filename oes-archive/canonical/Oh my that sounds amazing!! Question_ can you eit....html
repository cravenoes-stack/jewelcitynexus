<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Oh my that sounds amazing!! Question_ can you eit....docx</title>
  <meta name="robots" content="noindex, nofollow, noarchive, nosnippet, noimageindex">
</head>
<body>
<h2>OES Gemini Conversation Exporter: Complete Build Guide</h2><p>This guide contains all the necessary code and instructions to create your custom Chrome extension for exporting Gemini conversations. Follow these steps precisely.</p><h3><strong>Step 1: Create the Project Folders</strong></h3><p>First, you need to create the folder structure for your extension.</p><ol><li>On your computer, create a new folder and name it OES-Gemini-Exporter. This will be the main directory for your extension.</li><li>Inside the OES-Gemini-Exporter folder, create another folder and name it icons.</li></ol><p>Your folder structure should now look like this:</p><p>OES-Gemini-Exporter/<br />└── icons/<br /></p><h3><strong>Step 2: Create the Core Files</strong></h3><p>Now, create the following five text files inside the main OES-Gemini-Exporter folder. Copy the code provided for each file exactly.</p><h4><strong>1. manifest.json</strong></h4><p><em>(This is the extension's blueprint. It tells Chrome what the extension is, what permissions it needs, and where to find its files.)</em></p><p>{<br />  "manifest_version": 3,<br />  "name": "OES Gemini Conversation Exporter",<br />  "version": "1.1",<br />  "description": "Exports the currently active Gemini conversation to JSON, PDF, Markdown, or DOCX formats. Inspired by Mini.",<br />  "permissions": [<br />    "activeTab",<br />    "scripting",<br />    "downloads"<br />  ],<br />  "action": {<br />    "default_popup": "popup.html",<br />    "default_icon": {<br />      "16": "icons/icon16.png",<br />      "48": "icons/icon48.png",<br />      "128": "icons/icon128.png"<br />    }<br />  },<br />  "icons": {<br />    "16": "icons/icon16.png",<br />    "48": "icons/icon48.png",<br />    "128": "icons/icon128.png"<br />  },<br />  "background": {<br />    "service_worker": "background.js"<br />  }<br />}<br /></p><h4><strong>2. popup.html</strong></h4><p><em>(This file creates the small window that appears when you click the extension's icon in your browser toolbar.)</em></p><p>&lt;!DOCTYPE html&gt;<br />&lt;html lang="en"&gt;<br />&lt;head&gt;<br />    &lt;meta charset="UTF-8"&gt;<br />    &lt;title&gt;OES Exporter&lt;/title&gt;<br />    &lt;style&gt;<br />        body {<br />            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;<br />            width: 300px;<br />            padding: 20px;<br />            background-color: #1e1e1e;<br />            color: #d4d4d4;<br />        }<br />        h1 {<br />            font-size: 1.1rem;<br />            font-weight: 600;<br />            text-align: center;<br />            margin: 0 0 20px 0;<br />            color: #569cd6;<br />        }<br />        .format-group {<br />            margin-bottom: 20px;<br />        }<br />        .format-group fieldset {<br />            border: 1px solid #3c3c3c;<br />            border-radius: 6px;<br />            padding: 10px;<br />        }<br />        .format-group legend {<br />            padding: 0 5px;<br />            font-size: 0.9rem;<br />            font-weight: 500;<br />        }<br />        .radio-options {<br />            display: flex;<br />            justify-content: space-around;<br />        }<br />        .radio-options label {<br />            display: flex;<br />            align-items: center;<br />            cursor: pointer;<br />            font-size: 0.9rem;<br />        }<br />        .radio-options input {<br />            margin-right: 5px;<br />        }<br />        button {<br />            width: 100%;<br />            padding: 12px;<br />            border: none;<br />            border-radius: 6px;<br />            background-color: #0e639c;<br />            color: white;<br />            font-weight: 600;<br />            cursor: pointer;<br />            transition: background-color 0.2s;<br />        }<br />        button:hover {<br />            background-color: #1177bb;<br />        }<br />        button:disabled {<br />            background-color: #3c3c3c;<br />            cursor: not-allowed;<br />        }<br />        #status {<br />            text-align: center;<br />            margin-top: 15px;<br />            font-size: 0.8rem;<br />            color: #8a8a8a;<br />            height: 20px;<br />        }<br />    &lt;/style&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />    &lt;h1&gt;OES Gemini Exporter&lt;/h1&gt;<br />    &lt;div class="format-group"&gt;<br />        &lt;fieldset&gt;<br />            &lt;legend&gt;Export Format&lt;/legend&gt;<br />            &lt;div class="radio-options"&gt;<br />                &lt;label&gt;&lt;input type="radio" name="format" value="json" checked&gt; JSON&lt;/label&gt;<br />                &lt;label&gt;&lt;input type="radio" name="format" value="pdf"&gt; PDF&lt;/label&gt;<br />                &lt;label&gt;&lt;input type="radio" name="format" value="md"&gt; Markdown&lt;/label&gt;<br />                &lt;label&gt;&lt;input type="radio" name="format" value="docx"&gt; DOCX&lt;/label&gt;<br />            &lt;/div&gt;<br />        &lt;/fieldset&gt;<br />    &lt;/div&gt;<br />    &lt;button id="exportBtn"&gt;Export Conversation&lt;/button&gt;<br />    &lt;div id="status"&gt;&lt;/div&gt;<br />    &lt;script src="popup.js"&gt;&lt;/script&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /></p><h4><strong>3. popup.js</strong></h4><p><em>(This script controls the user interface of the popup, listening for your button clicks and initiating the export process.)</em></p><p>// This script controls the user interface of the extension's popup.<br /><br />const exportBtn = document.getElementById('exportBtn');<br />const statusDiv = document.getElementById('status');<br /><br />// Listen for clicks on the export button<br />exportBtn.addEventListener('click', async () =&gt; {<br />    // Disable the button and show a status message<br />    exportBtn.disabled = true;<br />    statusDiv.textContent = 'Scraping conversation...';<br /><br />    // Get the currently active tab in the current window<br />    const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });<br /><br />    // Check if we are on a Gemini page<br />    if (tab.url &amp;&amp; tab.url.startsWith("https://gemini.google.com/")) {<br />        // Inject the content script into the active tab<br />        try {<br />            const results = await chrome.scripting.executeScript({<br />                target: { tabId: tab.id },<br />                files: ['content.js']<br />            });<br /><br />            // The content script returns an array of results. We get the data from the first result.<br />            const conversationData = results[0].result;<br />            <br />            if (conversationData &amp;&amp; conversationData.length &gt; 0) {<br />                statusDiv.textContent = 'Generating file...';<br />                const format = document.querySelector('input[name="format"]:checked').value;<br /><br />                // Send the scraped data and format to the background script for processing<br />                chrome.runtime.sendMessage({<br />                    type: 'EXPORT_CONVERSATION',<br />                    payload: {<br />                        conversation: conversationData,<br />                        format: format,<br />                        title: tab.title // Use the page title for the filename<br />                    }<br />                });<br />            } else {<br />                statusDiv.textContent = 'No conversation found.';<br />            }<br />        } catch (error) {<br />            console.error("OES Exporter Error:", error);<br />            statusDiv.textContent = 'Error: Could not scrape page.';<br />        }<br />    } else {<br />        statusDiv.textContent = 'Not a Gemini conversation page.';<br />    }<br /><br />    // Re-enable the button after a short delay<br />    setTimeout(() =&gt; {<br />        exportBtn.disabled = false;<br />        statusDiv.textContent = '';<br />    }, 3000);<br />});<br /><br />// Listen for messages from the background script (e.g., when download is complete)<br />chrome.runtime.onMessage.addListener((message) =&gt; {<br />    if (message.type === 'DOWNLOAD_COMPLETE') {<br />        statusDiv.textContent = 'Export complete!';<br />    }<br />});<br /></p><h4><strong>4. content.js</strong></h4><p><em>(This script is the scraper. It gets injected into the Gemini webpage to read and extract the conversation content.)</em></p><p>// This script is injected into the Gemini page to extract the conversation.<br /><br />function scrapeConversation() {<br />    console.log("OES Exporter: Starting scrape...");<br />    const conversation = [];<br />    <br />    // Find all message containers. Gemini uses a 'response-container' class for each turn.<br />    const messageElements = document.querySelectorAll('.response-container');<br /><br />    if (messageElements.length === 0) {<br />        console.log("OES Exporter: No message containers found.");<br />        return [];<br />    }<br /><br />    messageElements.forEach(element =&gt; {<br />        // Within each container, find the user prompt<br />        const userPromptEl = element.querySelector('.query-container .query-text');<br />        if (userPromptEl) {<br />            conversation.push({<br />                role: 'user',<br />                content: userPromptEl.textContent.trim()<br />            });<br />        }<br /><br />        // Find the model's response parts<br />        // Responses can be complex, containing text, code blocks, etc.<br />        // We look for elements with the 'model-response-text' class.<br />        const modelResponseEls = element.querySelectorAll('.model-response-text .output-content');<br />        let modelContent = '';<br />        modelResponseEls.forEach(responsePart =&gt; {<br />            // We get the innerText to preserve formatting like line breaks<br />            modelContent += responsePart.innerText + '\n\n';<br />        });<br />        <br />        if (modelContent.trim()) {<br />            conversation.push({<br />                role: 'model',<br />                content: modelContent.trim()<br />            });<br />        }<br />    });<br /><br />    console.log(`OES Exporter: Scraped ${conversation.length} parts.`);<br />    return conversation;<br />}<br /><br />// The result of the last expression in a content script is returned to the caller.<br />scrapeConversation();<br /></p><h4><strong>5. background.js</strong></h4><p><em>(This is the background service worker. It handles the heavy lifting of creating the files in your chosen format and triggering the download.)</em></p><p>// This is the background service worker for the extension.<br />// It handles file generation and downloading.<br /><br />// Import third-party libraries for PDF and DOCX generation.<br />// These files must be in the same directory as this script.<br />importScripts('jspdf.umd.min.js', 'docx.umd.min.js');<br /><br />// Listen for messages from the popup script<br />chrome.runtime.onMessage.addListener((message, sender, sendResponse) =&gt; {<br />    if (message.type === 'EXPORT_CONVERSATION') {<br />        const { conversation, format, title } = message.payload;<br />        const sanitizedTitle = title.replace(/[^a-z0-9]/gi, '_').toLowerCase();<br />        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');<br />        const filename = `OES_Gemini_${sanitizedTitle}_${timestamp}`;<br /><br />        switch (format) {<br />            case 'json':<br />                exportAsJSON(conversation, `${filename}.json`);<br />                break;<br />            case 'md':<br />                exportAsMarkdown(conversation, `${filename}.md`);<br />                break;<br />            case 'pdf':<br />                exportAsPDF(conversation, `${filename}.pdf`);<br />                break;<br />            case 'docx':<br />                exportAsDOCX(conversation, `${filename}.docx`);<br />                break;<br />        }<br />    }<br />});<br /><br />function downloadFile(blob, filename) {<br />    const url = URL.createObjectURL(blob);<br />    chrome.downloads.download({<br />        url: url,<br />        filename: filename<br />    }, () =&gt; {<br />        // Revoke the object URL after the download starts to free up memory<br />        URL.revokeObjectURL(url);<br />        // Notify the popup that the download is complete<br />        chrome.runtime.sendMessage({ type: 'DOWNLOAD_COMPLETE' });<br />    });<br />}<br /><br />function exportAsJSON(data, filename) {<br />    const jsonString = JSON.stringify(data, null, 2);<br />    const blob = new Blob([jsonString], { type: 'application/json' });<br />    downloadFile(blob, filename);<br />}<br /><br />function exportAsMarkdown(data, filename) {<br />    let mdContent = '';<br />    data.forEach(item =&gt; {<br />        const role = item.role.charAt(0).toUpperCase() + item.role.slice(1);<br />        mdContent += `## ${role}\n\n`;<br />        mdContent += `${item.content}\n\n---\n\n`;<br />    });<br />    const blob = new Blob([mdContent], { type: 'text/markdown' });<br />    downloadFile(blob, filename);<br />}<br /><br />function exportAsPDF(data, filename) {<br />    const { jsPDF } = self.jspdf;<br />    const doc = new jsPDF();<br />    let y = 15;<br />    const pageHeight = doc.internal.pageSize.height;<br />    const margin = 10;<br /><br />    doc.setFontSize(18);<br />    doc.text("OES Gemini Conversation", margin, y);<br />    y += 10;<br /><br />    data.forEach(item =&gt; {<br />        const role = item.role.charAt(0).toUpperCase() + item.role.slice(1);<br />        <br />        doc.setFontSize(14);<br />        doc.setFont(undefined, 'bold');<br />        if (y &gt; pageHeight - 20) { doc.addPage(); y = margin; }<br />        doc.text(role, margin, y);<br />        y += 7;<br /><br />        doc.setFontSize(11);<br />        doc.setFont(undefined, 'normal');<br />        const lines = doc.splitTextToSize(item.content, 180);<br />        <br />        lines.forEach(line =&gt; {<br />            if (y &gt; pageHeight - 10) {<br />                doc.addPage();<br />                y = margin;<br />            }<br />            doc.text(line, margin, y);<br />            y += 5;<br />        });<br />        y += 5; // Extra space after each entry<br />    });<br /><br />    const pdfBlob = doc.output('blob');<br />    downloadFile(pdfBlob, filename);<br />}<br /><br />function exportAsDOCX(data, filename) {<br />    const { Document, Packer, Paragraph, TextRun, HeadingLevel } = self.docx;<br /><br />    const children = [];<br />    data.forEach(item =&gt; {<br />        const role = item.role.charAt(0).toUpperCase() + item.role.slice(1);<br />        children.push(new Paragraph({<br />            heading: HeadingLevel.HEADING_2,<br />            children: [new TextRun({ text: role, bold: true })],<br />        }));<br /><br />        // Split content by newlines to create separate paragraphs<br />        const contentLines = item.content.split('\n');<br />        contentLines.forEach(line =&gt; {<br />            children.push(new Paragraph(line));<br />        });<br />        children.push(new Paragraph("")); // Add a space between entries<br />    });<br /><br />    const doc = new Document({<br />        sections: [{<br />            properties: {},<br />            children: children,<br />        }],<br />    });<br /><br />    Packer.toBlob(doc).then(blob =&gt; {<br />        downloadFile(blob, filename);<br />    });<br />}<br /></p><h3><strong>Step 3: Add Helper Libraries</strong></h3><p>The extension needs two external libraries to create PDF and DOCX files.</p><ol><li><strong>Download jsPDF:</strong><ul><li>Go to this URL: https://raw.githubusercontent.com/MrRio/jsPDF/master/dist/jspdf.umd.min.js</li><li>Save the page's content as a file named jspdf.umd.min.js inside your OES-Gemini-Exporter folder.</li></ul></li><li><strong>Download docx:</strong><ul><li>Go to this URL: https://unpkg.com/docx@8.5.0/build/index.js</li><li>Save the page's content as a file named docx.umd.min.js inside your OES-Gemini-Exporter folder.</li></ul></li></ol><h3><strong>Step 4: Add Icons</strong></h3><p>Place three square PNG images inside the icons folder you created in Step 1. They must be named exactly:</p><ul><li>icon16.png (16x16 pixels)</li><li>icon48.png (48x48 pixels)</li><li>icon128.png (128x128 pixels)</li></ul><h3><strong>Step 5: Load the Extension in Chrome</strong></h3><p>Your project folder is now complete. The final step is to load it into Chrome.</p><ol><li>Open your Chrome browser and navigate to the extensions page by typing chrome://extensions in the address bar and pressing Enter.</li><li>In the top-right corner of the page, find the <strong>"Developer mode"</strong> toggle and turn it <strong>ON</strong>.</li><li>Three new buttons will appear. Click on the <strong>"Load unpacked"</strong> button.</li><li>A file selection dialog will open. Navigate to and select your OES-Gemini-Exporter folder.</li><li>The "OES Gemini Conversation Exporter" will now appear in your list of extensions and its icon will be added to your Chrome toolbar.</li></ol><p>You are now ready to use the extension. Navigate to any Gemini conversation, click the icon, select your desired format, and export.</p>
</body>
</html>